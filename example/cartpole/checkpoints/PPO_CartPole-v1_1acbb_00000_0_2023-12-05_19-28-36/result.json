{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 7.870939454035972}, "default_policy": {"total_loss": 7.870939454035972, "policy_loss": -0.02072518482021908, "vf_loss": 7.888245913519788, "vf_loss_unclipped": 222.0387878641645, "vf_explained_var": 0.08284165355950784, "entropy": 0.673518524304636, "mean_kl_loss": 0.017093688530998418, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 129.0, "episode_reward_min": 8.0, "episode_reward_mean": 24.21472392638037, "episode_len_mean": 24.21472392638037, "episode_media": {}, "episodes_this_iter": 163, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 29.0, 22.0, 26.0, 18.0, 25.0, 8.0, 38.0, 21.0, 26.0, 23.0, 15.0, 17.0, 53.0, 46.0, 35.0, 37.0, 37.0, 74.0, 33.0, 26.0, 10.0, 13.0, 75.0, 22.0, 16.0, 33.0, 21.0, 28.0, 12.0, 10.0, 18.0, 17.0, 31.0, 13.0, 31.0, 20.0, 12.0, 16.0, 32.0, 17.0, 15.0, 38.0, 22.0, 9.0, 12.0, 16.0, 13.0, 19.0, 24.0, 13.0, 13.0, 12.0, 17.0, 69.0, 15.0, 25.0, 16.0, 21.0, 12.0, 12.0, 37.0, 28.0, 27.0, 31.0, 14.0, 14.0, 15.0, 40.0, 19.0, 14.0, 13.0, 27.0, 12.0, 18.0, 17.0, 38.0, 32.0, 25.0, 24.0, 27.0, 17.0, 26.0, 29.0, 23.0, 10.0, 19.0, 29.0, 45.0, 15.0, 17.0, 13.0, 18.0, 22.0, 19.0, 30.0, 17.0, 31.0, 35.0, 22.0, 33.0, 23.0, 12.0, 41.0, 12.0, 27.0, 25.0, 23.0, 24.0, 23.0, 69.0, 37.0, 25.0, 35.0, 28.0, 24.0, 17.0, 13.0, 10.0, 25.0, 33.0, 30.0, 12.0, 16.0, 12.0, 29.0, 19.0, 15.0, 31.0, 13.0, 51.0, 16.0, 17.0, 24.0, 27.0, 14.0, 19.0, 11.0, 15.0, 27.0, 14.0, 13.0, 48.0, 13.0, 9.0, 129.0, 17.0, 29.0, 10.0, 23.0, 16.0, 32.0, 26.0, 9.0, 39.0, 36.0, 20.0, 19.0, 24.0, 14.0, 11.0, 38.0, 20.0], "episode_lengths": [23, 29, 22, 26, 18, 25, 8, 38, 21, 26, 23, 15, 17, 53, 46, 35, 37, 37, 74, 33, 26, 10, 13, 75, 22, 16, 33, 21, 28, 12, 10, 18, 17, 31, 13, 31, 20, 12, 16, 32, 17, 15, 38, 22, 9, 12, 16, 13, 19, 24, 13, 13, 12, 17, 69, 15, 25, 16, 21, 12, 12, 37, 28, 27, 31, 14, 14, 15, 40, 19, 14, 13, 27, 12, 18, 17, 38, 32, 25, 24, 27, 17, 26, 29, 23, 10, 19, 29, 45, 15, 17, 13, 18, 22, 19, 30, 17, 31, 35, 22, 33, 23, 12, 41, 12, 27, 25, 23, 24, 23, 69, 37, 25, 35, 28, 24, 17, 13, 10, 25, 33, 30, 12, 16, 12, 29, 19, 15, 31, 13, 51, 16, 17, 24, 27, 14, 19, 11, 15, 27, 14, 13, 48, 13, 9, 129, 17, 29, 10, 23, 16, 32, 26, 9, 39, 36, 20, 19, 24, 14, 11, 38, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4875834617570654, "mean_inference_ms": 1.4687786510532548, "mean_action_processing_ms": 0.11673503388525583, "mean_env_wait_ms": 0.0577410467482458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00626645936556389, "StateBufferConnector_ms": 0.0041389757870165115, "ViewRequirementAgentConnector_ms": 0.2640441882829725}}, "episode_reward_max": 129.0, "episode_reward_min": 8.0, "episode_reward_mean": 24.21472392638037, "episode_len_mean": 24.21472392638037, "episodes_this_iter": 163, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.0, 29.0, 22.0, 26.0, 18.0, 25.0, 8.0, 38.0, 21.0, 26.0, 23.0, 15.0, 17.0, 53.0, 46.0, 35.0, 37.0, 37.0, 74.0, 33.0, 26.0, 10.0, 13.0, 75.0, 22.0, 16.0, 33.0, 21.0, 28.0, 12.0, 10.0, 18.0, 17.0, 31.0, 13.0, 31.0, 20.0, 12.0, 16.0, 32.0, 17.0, 15.0, 38.0, 22.0, 9.0, 12.0, 16.0, 13.0, 19.0, 24.0, 13.0, 13.0, 12.0, 17.0, 69.0, 15.0, 25.0, 16.0, 21.0, 12.0, 12.0, 37.0, 28.0, 27.0, 31.0, 14.0, 14.0, 15.0, 40.0, 19.0, 14.0, 13.0, 27.0, 12.0, 18.0, 17.0, 38.0, 32.0, 25.0, 24.0, 27.0, 17.0, 26.0, 29.0, 23.0, 10.0, 19.0, 29.0, 45.0, 15.0, 17.0, 13.0, 18.0, 22.0, 19.0, 30.0, 17.0, 31.0, 35.0, 22.0, 33.0, 23.0, 12.0, 41.0, 12.0, 27.0, 25.0, 23.0, 24.0, 23.0, 69.0, 37.0, 25.0, 35.0, 28.0, 24.0, 17.0, 13.0, 10.0, 25.0, 33.0, 30.0, 12.0, 16.0, 12.0, 29.0, 19.0, 15.0, 31.0, 13.0, 51.0, 16.0, 17.0, 24.0, 27.0, 14.0, 19.0, 11.0, 15.0, 27.0, 14.0, 13.0, 48.0, 13.0, 9.0, 129.0, 17.0, 29.0, 10.0, 23.0, 16.0, 32.0, 26.0, 9.0, 39.0, 36.0, 20.0, 19.0, 24.0, 14.0, 11.0, 38.0, 20.0], "episode_lengths": [23, 29, 22, 26, 18, 25, 8, 38, 21, 26, 23, 15, 17, 53, 46, 35, 37, 37, 74, 33, 26, 10, 13, 75, 22, 16, 33, 21, 28, 12, 10, 18, 17, 31, 13, 31, 20, 12, 16, 32, 17, 15, 38, 22, 9, 12, 16, 13, 19, 24, 13, 13, 12, 17, 69, 15, 25, 16, 21, 12, 12, 37, 28, 27, 31, 14, 14, 15, 40, 19, 14, 13, 27, 12, 18, 17, 38, 32, 25, 24, 27, 17, 26, 29, 23, 10, 19, 29, 45, 15, 17, 13, 18, 22, 19, 30, 17, 31, 35, 22, 33, 23, 12, 41, 12, 27, 25, 23, 24, 23, 69, 37, 25, 35, 28, 24, 17, 13, 10, 25, 33, 30, 12, 16, 12, 29, 19, 15, 31, 13, 51, 16, 17, 24, 27, 14, 19, 11, 15, 27, 14, 13, 48, 13, 9, 129, 17, 29, 10, 23, 16, 32, 26, 9, 39, 36, 20, 19, 24, 14, 11, 38, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4875834617570654, "mean_inference_ms": 1.4687786510532548, "mean_action_processing_ms": 0.11673503388525583, "mean_env_wait_ms": 0.0577410467482458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00626645936556389, "StateBufferConnector_ms": 0.0041389757870165115, "ViewRequirementAgentConnector_ms": 0.2640441882829725}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 370.0216169946004, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10810.145, "sample_time_ms": 4349.727, "synch_weights_time_ms": 2.999}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 163, "training_iteration": 1, "trial_id": "1acbb_00000", "date": "2023-12-05_19-28-59", "timestamp": 1701800939, "time_this_iter_s": 10.814836978912354, "time_total_s": 10.814836978912354, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10.814836978912354, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.14375, "ram_util_percent": 93.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 8.07054191611723}, "default_policy": {"total_loss": 8.07054191611723, "policy_loss": -0.027071647709910707, "vf_loss": 8.094562550851785, "vf_loss_unclipped": 287.4068266049123, "vf_explained_var": 0.15124034449489895, "entropy": 0.6283795194966453, "mean_kl_loss": 0.015254974801828677, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 104.0, "episode_reward_min": 9.0, "episode_reward_mean": 35.52212389380531, "episode_len_mean": 35.52212389380531, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 31.0, 19.0, 83.0, 19.0, 53.0, 43.0, 19.0, 17.0, 39.0, 49.0, 52.0, 39.0, 21.0, 27.0, 46.0, 9.0, 23.0, 38.0, 85.0, 10.0, 28.0, 19.0, 24.0, 19.0, 46.0, 24.0, 16.0, 18.0, 16.0, 21.0, 29.0, 13.0, 13.0, 20.0, 16.0, 26.0, 42.0, 20.0, 18.0, 41.0, 41.0, 65.0, 12.0, 80.0, 22.0, 49.0, 29.0, 61.0, 64.0, 12.0, 16.0, 48.0, 22.0, 44.0, 59.0, 71.0, 33.0, 52.0, 16.0, 24.0, 49.0, 43.0, 51.0, 39.0, 58.0, 28.0, 29.0, 35.0, 12.0, 24.0, 15.0, 62.0, 37.0, 17.0, 18.0, 32.0, 26.0, 104.0, 20.0, 31.0, 76.0, 23.0, 28.0, 41.0, 31.0, 13.0, 53.0, 103.0, 30.0, 50.0, 13.0, 13.0, 35.0, 34.0, 32.0, 28.0, 66.0, 75.0, 40.0, 12.0, 27.0, 51.0, 12.0, 12.0, 31.0, 26.0, 36.0, 66.0, 24.0, 94.0, 28.0, 28.0], "episode_lengths": [42, 31, 19, 83, 19, 53, 43, 19, 17, 39, 49, 52, 39, 21, 27, 46, 9, 23, 38, 85, 10, 28, 19, 24, 19, 46, 24, 16, 18, 16, 21, 29, 13, 13, 20, 16, 26, 42, 20, 18, 41, 41, 65, 12, 80, 22, 49, 29, 61, 64, 12, 16, 48, 22, 44, 59, 71, 33, 52, 16, 24, 49, 43, 51, 39, 58, 28, 29, 35, 12, 24, 15, 62, 37, 17, 18, 32, 26, 104, 20, 31, 76, 23, 28, 41, 31, 13, 53, 103, 30, 50, 13, 13, 35, 34, 32, 28, 66, 75, 40, 12, 27, 51, 12, 12, 31, 26, 36, 66, 24, 94, 28, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4810341764322165, "mean_inference_ms": 1.4697759258873213, "mean_action_processing_ms": 0.116506054979086, "mean_env_wait_ms": 0.057841818154846805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006113010170185461, "StateBufferConnector_ms": 0.003972728695489664, "ViewRequirementAgentConnector_ms": 0.2656546314205744}}, "episode_reward_max": 104.0, "episode_reward_min": 9.0, "episode_reward_mean": 35.52212389380531, "episode_len_mean": 35.52212389380531, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.0, 31.0, 19.0, 83.0, 19.0, 53.0, 43.0, 19.0, 17.0, 39.0, 49.0, 52.0, 39.0, 21.0, 27.0, 46.0, 9.0, 23.0, 38.0, 85.0, 10.0, 28.0, 19.0, 24.0, 19.0, 46.0, 24.0, 16.0, 18.0, 16.0, 21.0, 29.0, 13.0, 13.0, 20.0, 16.0, 26.0, 42.0, 20.0, 18.0, 41.0, 41.0, 65.0, 12.0, 80.0, 22.0, 49.0, 29.0, 61.0, 64.0, 12.0, 16.0, 48.0, 22.0, 44.0, 59.0, 71.0, 33.0, 52.0, 16.0, 24.0, 49.0, 43.0, 51.0, 39.0, 58.0, 28.0, 29.0, 35.0, 12.0, 24.0, 15.0, 62.0, 37.0, 17.0, 18.0, 32.0, 26.0, 104.0, 20.0, 31.0, 76.0, 23.0, 28.0, 41.0, 31.0, 13.0, 53.0, 103.0, 30.0, 50.0, 13.0, 13.0, 35.0, 34.0, 32.0, 28.0, 66.0, 75.0, 40.0, 12.0, 27.0, 51.0, 12.0, 12.0, 31.0, 26.0, 36.0, 66.0, 24.0, 94.0, 28.0, 28.0], "episode_lengths": [42, 31, 19, 83, 19, 53, 43, 19, 17, 39, 49, 52, 39, 21, 27, 46, 9, 23, 38, 85, 10, 28, 19, 24, 19, 46, 24, 16, 18, 16, 21, 29, 13, 13, 20, 16, 26, 42, 20, 18, 41, 41, 65, 12, 80, 22, 49, 29, 61, 64, 12, 16, 48, 22, 44, 59, 71, 33, 52, 16, 24, 49, 43, 51, 39, 58, 28, 29, 35, 12, 24, 15, 62, 37, 17, 18, 32, 26, 104, 20, 31, 76, 23, 28, 41, 31, 13, 53, 103, 30, 50, 13, 13, 35, 34, 32, 28, 66, 75, 40, 12, 27, 51, 12, 12, 31, 26, 36, 66, 24, 94, 28, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4810341764322165, "mean_inference_ms": 1.4697759258873213, "mean_action_processing_ms": 0.116506054979086, "mean_env_wait_ms": 0.057841818154846805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006113010170185461, "StateBufferConnector_ms": 0.003972728695489664, "ViewRequirementAgentConnector_ms": 0.2656546314205744}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 369.8434132203485, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10812.746, "sample_time_ms": 4326.225, "synch_weights_time_ms": 3.193}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 276, "training_iteration": 2, "trial_id": "1acbb_00000", "date": "2023-12-05_19-29-09", "timestamp": 1701800949, "time_this_iter_s": 10.819515228271484, "time_total_s": 21.634352207183838, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 21.634352207183838, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.813333333333333, "ram_util_percent": 93.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.016281547831065}, "default_policy": {"total_loss": 9.016281547831065, "policy_loss": -0.01610133842950357, "vf_loss": 9.030000975899604, "vf_loss_unclipped": 999.1622590591659, "vf_explained_var": 0.07922604355984914, "entropy": 0.602557128616996, "mean_kl_loss": 0.011909618054863099, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 172.0, "episode_reward_min": 12.0, "episode_reward_mean": 55.08, "episode_len_mean": 55.08, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 17.0, 18.0, 32.0, 26.0, 104.0, 20.0, 31.0, 76.0, 23.0, 28.0, 41.0, 31.0, 13.0, 53.0, 103.0, 30.0, 50.0, 13.0, 13.0, 35.0, 34.0, 32.0, 28.0, 66.0, 75.0, 40.0, 12.0, 27.0, 51.0, 12.0, 12.0, 31.0, 26.0, 36.0, 66.0, 24.0, 94.0, 28.0, 28.0, 41.0, 58.0, 53.0, 172.0, 27.0, 117.0, 35.0, 13.0, 91.0, 57.0, 140.0, 76.0, 103.0, 27.0, 75.0, 117.0, 41.0, 51.0, 33.0, 27.0, 75.0, 60.0, 167.0, 12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0], "episode_lengths": [37, 17, 18, 32, 26, 104, 20, 31, 76, 23, 28, 41, 31, 13, 53, 103, 30, 50, 13, 13, 35, 34, 32, 28, 66, 75, 40, 12, 27, 51, 12, 12, 31, 26, 36, 66, 24, 94, 28, 28, 41, 58, 53, 172, 27, 117, 35, 13, 91, 57, 140, 76, 103, 27, 75, 117, 41, 51, 33, 27, 75, 60, 167, 12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4756052407841746, "mean_inference_ms": 1.4713687893116196, "mean_action_processing_ms": 0.11605977974063109, "mean_env_wait_ms": 0.057824972531880764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006158113479614258, "StateBufferConnector_ms": 0.003945827484130859, "ViewRequirementAgentConnector_ms": 0.2631216049194336}}, "episode_reward_max": 172.0, "episode_reward_min": 12.0, "episode_reward_mean": 55.08, "episode_len_mean": 55.08, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.0, 17.0, 18.0, 32.0, 26.0, 104.0, 20.0, 31.0, 76.0, 23.0, 28.0, 41.0, 31.0, 13.0, 53.0, 103.0, 30.0, 50.0, 13.0, 13.0, 35.0, 34.0, 32.0, 28.0, 66.0, 75.0, 40.0, 12.0, 27.0, 51.0, 12.0, 12.0, 31.0, 26.0, 36.0, 66.0, 24.0, 94.0, 28.0, 28.0, 41.0, 58.0, 53.0, 172.0, 27.0, 117.0, 35.0, 13.0, 91.0, 57.0, 140.0, 76.0, 103.0, 27.0, 75.0, 117.0, 41.0, 51.0, 33.0, 27.0, 75.0, 60.0, 167.0, 12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0], "episode_lengths": [37, 17, 18, 32, 26, 104, 20, 31, 76, 23, 28, 41, 31, 13, 53, 103, 30, 50, 13, 13, 35, 34, 32, 28, 66, 75, 40, 12, 27, 51, 12, 12, 31, 26, 36, 66, 24, 94, 28, 28, 41, 58, 53, 172, 27, 117, 35, 13, 91, 57, 140, 76, 103, 27, 75, 117, 41, 51, 33, 27, 75, 60, 167, 12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4756052407841746, "mean_inference_ms": 1.4713687893116196, "mean_action_processing_ms": 0.11605977974063109, "mean_env_wait_ms": 0.057824972531880764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006158113479614258, "StateBufferConnector_ms": 0.003945827484130859, "ViewRequirementAgentConnector_ms": 0.2631216049194336}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 373.5680899961303, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10777.671, "sample_time_ms": 4295.462, "synch_weights_time_ms": 3.249}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 336, "training_iteration": 3, "trial_id": "1acbb_00000", "date": "2023-12-05_19-29-20", "timestamp": 1701800960, "time_this_iter_s": 10.710545063018799, "time_total_s": 32.34489727020264, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 32.34489727020264, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.56875, "ram_util_percent": 93.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.54783183221878}, "default_policy": {"total_loss": 9.54783183221878, "policy_loss": -0.010535696087512317, "vf_loss": 9.556986704055689, "vf_loss_unclipped": 2718.320130403108, "vf_explained_var": 0.03249608625226946, "entropy": 0.5901336871993059, "mean_kl_loss": 0.006903966879157129, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 83.88, "episode_len_mean": 83.88, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 28.0, 66.0, 75.0, 40.0, 12.0, 27.0, 51.0, 12.0, 12.0, 31.0, 26.0, 36.0, 66.0, 24.0, 94.0, 28.0, 28.0, 41.0, 58.0, 53.0, 172.0, 27.0, 117.0, 35.0, 13.0, 91.0, 57.0, 140.0, 76.0, 103.0, 27.0, 75.0, 117.0, 41.0, 51.0, 33.0, 27.0, 75.0, 60.0, 167.0, 12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0], "episode_lengths": [32, 28, 66, 75, 40, 12, 27, 51, 12, 12, 31, 26, 36, 66, 24, 94, 28, 28, 41, 58, 53, 172, 27, 117, 35, 13, 91, 57, 140, 76, 103, 27, 75, 117, 41, 51, 33, 27, 75, 60, 167, 12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711006672581843, "mean_inference_ms": 1.468071071318158, "mean_action_processing_ms": 0.11607858091328344, "mean_env_wait_ms": 0.05776392102331334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00600886344909668, "StateBufferConnector_ms": 0.00390625, "ViewRequirementAgentConnector_ms": 0.2609577178955078}}, "episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 83.88, "episode_len_mean": 83.88, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 28.0, 66.0, 75.0, 40.0, 12.0, 27.0, 51.0, 12.0, 12.0, 31.0, 26.0, 36.0, 66.0, 24.0, 94.0, 28.0, 28.0, 41.0, 58.0, 53.0, 172.0, 27.0, 117.0, 35.0, 13.0, 91.0, 57.0, 140.0, 76.0, 103.0, 27.0, 75.0, 117.0, 41.0, 51.0, 33.0, 27.0, 75.0, 60.0, 167.0, 12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0], "episode_lengths": [32, 28, 66, 75, 40, 12, 27, 51, 12, 12, 31, 26, 36, 66, 24, 94, 28, 28, 41, 58, 53, 172, 27, 117, 35, 13, 91, 57, 140, 76, 103, 27, 75, 117, 41, 51, 33, 27, 75, 60, 167, 12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711006672581843, "mean_inference_ms": 1.468071071318158, "mean_action_processing_ms": 0.11607858091328344, "mean_env_wait_ms": 0.05776392102331334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00600886344909668, "StateBufferConnector_ms": 0.00390625, "ViewRequirementAgentConnector_ms": 0.2609577178955078}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 373.8887666157398, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10757.833, "sample_time_ms": 4267.606, "synch_weights_time_ms": 3.217}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 358, "training_iteration": 4, "trial_id": "1acbb_00000", "date": "2023-12-05_19-29-31", "timestamp": 1701800971, "time_this_iter_s": 10.701524496078491, "time_total_s": 43.04642176628113, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 43.04642176628113, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.84666666666666, "ram_util_percent": 93.84000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.699900223502219}, "default_policy": {"total_loss": 9.699900223502219, "policy_loss": -0.004921107768897277, "vf_loss": 9.703858247443812, "vf_loss_unclipped": 3210.9534850293385, "vf_explained_var": 0.011970298122495476, "entropy": 0.5781681104255384, "mean_kl_loss": 0.004815529453381525, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 117.84, "episode_len_mean": 117.84, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 28.0, 41.0, 58.0, 53.0, 172.0, 27.0, 117.0, 35.0, 13.0, 91.0, 57.0, 140.0, 76.0, 103.0, 27.0, 75.0, 117.0, 41.0, 51.0, 33.0, 27.0, 75.0, 60.0, 167.0, 12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0], "episode_lengths": [28, 28, 41, 58, 53, 172, 27, 117, 35, 13, 91, 57, 140, 76, 103, 27, 75, 117, 41, 51, 33, 27, 75, 60, 167, 12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4671423361316107, "mean_inference_ms": 1.466403825220775, "mean_action_processing_ms": 0.11614025419227436, "mean_env_wait_ms": 0.05775134015890978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061130523681640625, "StateBufferConnector_ms": 0.003932476043701172, "ViewRequirementAgentConnector_ms": 0.2634239196777344}}, "episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 117.84, "episode_len_mean": 117.84, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.0, 28.0, 41.0, 58.0, 53.0, 172.0, 27.0, 117.0, 35.0, 13.0, 91.0, 57.0, 140.0, 76.0, 103.0, 27.0, 75.0, 117.0, 41.0, 51.0, 33.0, 27.0, 75.0, 60.0, 167.0, 12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0], "episode_lengths": [28, 28, 41, 58, 53, 172, 27, 117, 35, 13, 91, 57, 140, 76, 103, 27, 75, 117, 41, 51, 33, 27, 75, 60, 167, 12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4671423361316107, "mean_inference_ms": 1.466403825220775, "mean_action_processing_ms": 0.11614025419227436, "mean_env_wait_ms": 0.05775134015890978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061130523681640625, "StateBufferConnector_ms": 0.003932476043701172, "ViewRequirementAgentConnector_ms": 0.2634239196777344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 375.6147766656696, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 10736.102, "sample_time_ms": 4266.745, "synch_weights_time_ms": 3.233}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 374, "training_iteration": 5, "trial_id": "1acbb_00000", "date": "2023-12-05_19-29-42", "timestamp": 1701800982, "time_this_iter_s": 10.652217864990234, "time_total_s": 53.69863963127136, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 53.69863963127136, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.693333333333335, "ram_util_percent": 93.92000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.771884408841}, "default_policy": {"total_loss": 9.771884408841, "policy_loss": -0.005883631391772456, "vf_loss": 9.777101926457908, "vf_loss_unclipped": 3446.5245578660133, "vf_explained_var": -0.0080456248859861, "entropy": 0.5634740764843121, "mean_kl_loss": 0.006661421673856534, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 147.86, "episode_len_mean": 147.86, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 103.0, 27.0, 75.0, 117.0, 41.0, 51.0, 33.0, 27.0, 75.0, 60.0, 167.0, 12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0], "episode_lengths": [76, 103, 27, 75, 117, 41, 51, 33, 27, 75, 60, 167, 12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4645577068712084, "mean_inference_ms": 1.4657334596130283, "mean_action_processing_ms": 0.1160066828976069, "mean_env_wait_ms": 0.057737918457380924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006105661392211914, "StateBufferConnector_ms": 0.003933429718017578, "ViewRequirementAgentConnector_ms": 0.26386308670043945}}, "episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 147.86, "episode_len_mean": 147.86, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 103.0, 27.0, 75.0, 117.0, 41.0, 51.0, 33.0, 27.0, 75.0, 60.0, 167.0, 12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0], "episode_lengths": [76, 103, 27, 75, 117, 41, 51, 33, 27, 75, 60, 167, 12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4645577068712084, "mean_inference_ms": 1.4657334596130283, "mean_action_processing_ms": 0.1160066828976069, "mean_env_wait_ms": 0.057737918457380924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006105661392211914, "StateBufferConnector_ms": 0.003933429718017578, "ViewRequirementAgentConnector_ms": 0.26386308670043945}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 379.9429913944032, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10701.396, "sample_time_ms": 4241.447, "synch_weights_time_ms": 3.224}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 387, "training_iteration": 6, "trial_id": "1acbb_00000", "date": "2023-12-05_19-29-52", "timestamp": 1701800992, "time_this_iter_s": 10.531017780303955, "time_total_s": 64.22965741157532, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 64.22965741157532, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.38, "ram_util_percent": 93.90000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.801141780576726}, "default_policy": {"total_loss": 9.801141780576726, "policy_loss": -0.0066967011212921345, "vf_loss": 9.806765204553665, "vf_loss_unclipped": 3496.974929842105, "vf_explained_var": -0.04887788935002488, "entropy": 0.5574010176889932, "mean_kl_loss": 0.01073299002198135, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 181.76, "episode_len_mean": 181.76, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0], "episode_lengths": [12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4620537736245244, "mean_inference_ms": 1.4653249004270017, "mean_action_processing_ms": 0.11584666924666472, "mean_env_wait_ms": 0.05773307106366154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060498714447021484, "StateBufferConnector_ms": 0.003941535949707031, "ViewRequirementAgentConnector_ms": 0.2633326053619385}}, "episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 181.76, "episode_len_mean": 181.76, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.0, 172.0, 75.0, 77.0, 17.0, 53.0, 18.0, 127.0, 79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0], "episode_lengths": [12, 172, 75, 77, 17, 53, 18, 127, 79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4620537736245244, "mean_inference_ms": 1.4653249004270017, "mean_action_processing_ms": 0.11584666924666472, "mean_env_wait_ms": 0.05773307106366154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060498714447021484, "StateBufferConnector_ms": 0.003941535949707031, "ViewRequirementAgentConnector_ms": 0.2633326053619385}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 375.92179421619824, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 10692.694, "sample_time_ms": 4231.299, "synch_weights_time_ms": 3.195}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 399, "training_iteration": 7, "trial_id": "1acbb_00000", "date": "2023-12-05_19-30-03", "timestamp": 1701801003, "time_this_iter_s": 10.643478870391846, "time_total_s": 74.87313628196716, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 74.87313628196716, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.79333333333333, "ram_util_percent": 93.88000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.880780777189015}, "default_policy": {"total_loss": 9.880780777189015, "policy_loss": -0.002270184574462076, "vf_loss": 9.882665773444593, "vf_loss_unclipped": 3949.074906794501, "vf_explained_var": -0.20827811403569382, "entropy": 0.5282644097294126, "mean_kl_loss": 0.003852236319695199, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 212.72, "episode_len_mean": 212.72, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4601428210179525, "mean_inference_ms": 1.4647130925429928, "mean_action_processing_ms": 0.11580696279930819, "mean_env_wait_ms": 0.0577234847122912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006005287170410156, "StateBufferConnector_ms": 0.003939628601074219, "ViewRequirementAgentConnector_ms": 0.2635471820831299}}, "episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 212.72, "episode_len_mean": 212.72, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [79.0, 17.0, 27.0, 110.0, 92.0, 36.0, 20.0, 116.0, 37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [79, 17, 27, 110, 92, 36, 20, 116, 37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4601428210179525, "mean_inference_ms": 1.4647130925429928, "mean_action_processing_ms": 0.11580696279930819, "mean_env_wait_ms": 0.0577234847122912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006005287170410156, "StateBufferConnector_ms": 0.003939628601074219, "ViewRequirementAgentConnector_ms": 0.2635471820831299}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 380.1329752693116, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 10671.433, "sample_time_ms": 4227.813, "synch_weights_time_ms": 3.161}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 407, "training_iteration": 8, "trial_id": "1acbb_00000", "date": "2023-12-05_19-30-13", "timestamp": 1701801013, "time_this_iter_s": 10.525342226028442, "time_total_s": 85.3984785079956, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 85.3984785079956, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.40666666666667, "ram_util_percent": 93.88000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.871786856702142}, "default_policy": {"total_loss": 9.871786856702142, "policy_loss": -0.002071487932041017, "vf_loss": 9.87345572168639, "vf_loss_unclipped": 3580.768008624567, "vf_explained_var": -0.12749403588044872, "entropy": 0.5329510350026556, "mean_kl_loss": 0.00805258704856408, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 246.12, "episode_len_mean": 246.12, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0], "episode_lengths": [37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4580286917650905, "mean_inference_ms": 1.4637658456868423, "mean_action_processing_ms": 0.1158245428220831, "mean_env_wait_ms": 0.05770770561777582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005913257598876953, "StateBufferConnector_ms": 0.003906726837158203, "ViewRequirementAgentConnector_ms": 0.26233983039855957}}, "episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 246.12, "episode_len_mean": 246.12, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.0, 102.0, 31.0, 97.0, 124.0, 63.0, 39.0, 17.0, 33.0, 22.0, 60.0, 42.0, 77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0], "episode_lengths": [37, 102, 31, 97, 124, 63, 39, 17, 33, 22, 60, 42, 77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4580286917650905, "mean_inference_ms": 1.4637658456868423, "mean_action_processing_ms": 0.1158245428220831, "mean_env_wait_ms": 0.05770770561777582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005913257598876953, "StateBufferConnector_ms": 0.003906726837158203, "ViewRequirementAgentConnector_ms": 0.26233983039855957}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 379.70869382977355, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 10656.202, "sample_time_ms": 4225.293, "synch_weights_time_ms": 3.166}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 415, "training_iteration": 9, "trial_id": "1acbb_00000", "date": "2023-12-05_19-30-24", "timestamp": 1701801024, "time_this_iter_s": 10.537258625030518, "time_total_s": 95.93573713302612, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 95.93573713302612, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.446666666666665, "ram_util_percent": 93.71999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.74255008026481}, "default_policy": {"total_loss": 9.74255008026481, "policy_loss": -0.0026565619341250677, "vf_loss": 9.744905281676921, "vf_loss_unclipped": 2625.873887604996, "vf_explained_var": 0.08448963798185401, "entropy": 0.547073072207762, "mean_kl_loss": 0.006027048225443478, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 19.0, "episode_reward_mean": 285.68, "episode_len_mean": 285.68, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0], "episode_lengths": [77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45491425800539, "mean_inference_ms": 1.463169095545225, "mean_action_processing_ms": 0.11590251374096862, "mean_env_wait_ms": 0.0577132074608517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060002803802490234, "StateBufferConnector_ms": 0.003945350646972656, "ViewRequirementAgentConnector_ms": 0.2648141384124756}}, "episode_reward_max": 500.0, "episode_reward_min": 19.0, "episode_reward_mean": 285.68, "episode_len_mean": 285.68, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [77.0, 100.0, 26.0, 95.0, 19.0, 152.0, 41.0, 23.0, 88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0], "episode_lengths": [77, 100, 26, 95, 19, 152, 41, 23, 88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45491425800539, "mean_inference_ms": 1.463169095545225, "mean_action_processing_ms": 0.11590251374096862, "mean_env_wait_ms": 0.0577132074608517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060002803802490234, "StateBufferConnector_ms": 0.003945350646972656, "ViewRequirementAgentConnector_ms": 0.2648141384124756}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 375.09602810905767, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 10656.972, "sample_time_ms": 4241.67, "synch_weights_time_ms": 3.184}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 427, "training_iteration": 10, "trial_id": "1acbb_00000", "date": "2023-12-05_19-30-35", "timestamp": 1701801035, "time_this_iter_s": 10.66675877571106, "time_total_s": 106.60249590873718, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 106.60249590873718, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.693333333333335, "ram_util_percent": 93.69333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.843400114380728}, "default_policy": {"total_loss": 9.843400114380728, "policy_loss": -0.004601093869694054, "vf_loss": 9.847560358962525, "vf_loss_unclipped": 2934.3204294623597, "vf_explained_var": -0.01167932692875486, "entropy": 0.5229722223619917, "mean_kl_loss": 0.008817137725033716, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 28.0, "episode_reward_mean": 316.45, "episode_len_mean": 316.45, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4526214095239017, "mean_inference_ms": 1.4623619479849028, "mean_action_processing_ms": 0.11592249376931513, "mean_env_wait_ms": 0.05770041872152039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005878925323486328, "StateBufferConnector_ms": 0.003906726837158203, "ViewRequirementAgentConnector_ms": 0.2642180919647217}}, "episode_reward_max": 500.0, "episode_reward_min": 28.0, "episode_reward_mean": 316.45, "episode_len_mean": 316.45, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [88.0, 114.0, 375.0, 82.0, 91.0, 154.0, 109.0, 112.0, 149.0, 135.0, 28.0, 130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [88, 114, 375, 82, 91, 154, 109, 112, 149, 135, 28, 130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4526214095239017, "mean_inference_ms": 1.4623619479849028, "mean_action_processing_ms": 0.11592249376931513, "mean_env_wait_ms": 0.05770041872152039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005878925323486328, "StateBufferConnector_ms": 0.003906726837158203, "ViewRequirementAgentConnector_ms": 0.2642180919647217}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 396.0263701965396, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 10585.987, "sample_time_ms": 4210.06, "synch_weights_time_ms": 3.201}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 435, "training_iteration": 11, "trial_id": "1acbb_00000", "date": "2023-12-05_19-30-45", "timestamp": 1701801045, "time_this_iter_s": 10.103345394134521, "time_total_s": 116.7058413028717, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 116.7058413028717, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.053333333333335, "ram_util_percent": 93.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.789848396773023}, "default_policy": {"total_loss": 9.789848396773023, "policy_loss": -0.005571971422057353, "vf_loss": 9.794914281190332, "vf_loss_unclipped": 2120.007039019294, "vf_explained_var": -0.006720734557617448, "entropy": 0.5475935175665406, "mean_kl_loss": 0.010121905957305655, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 76.0, "episode_reward_mean": 344.16, "episode_len_mean": 344.16, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0], "episode_lengths": [130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45026302107706656, "mean_inference_ms": 1.461660093199649, "mean_action_processing_ms": 0.1157928819940877, "mean_env_wait_ms": 0.05768156902589638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005833625793457031, "StateBufferConnector_ms": 0.003901958465576172, "ViewRequirementAgentConnector_ms": 0.26361846923828125}}, "episode_reward_max": 500.0, "episode_reward_min": 76.0, "episode_reward_mean": 344.16, "episode_len_mean": 344.16, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [130.0, 153.0, 109.0, 161.0, 205.0, 157.0, 281.0, 500.0, 153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0], "episode_lengths": [130, 153, 109, 161, 205, 157, 281, 500, 153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45026302107706656, "mean_inference_ms": 1.461660093199649, "mean_action_processing_ms": 0.1157928819940877, "mean_env_wait_ms": 0.05768156902589638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005833625793457031, "StateBufferConnector_ms": 0.003901958465576172, "ViewRequirementAgentConnector_ms": 0.26361846923828125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 383.40241092270315, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10547.734, "sample_time_ms": 4186.158, "synch_weights_time_ms": 3.618}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 446, "training_iteration": 12, "trial_id": "1acbb_00000", "date": "2023-12-05_19-30-55", "timestamp": 1701801055, "time_this_iter_s": 10.439618825912476, "time_total_s": 127.14546012878418, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 127.14546012878418, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.16666666666667, "ram_util_percent": 93.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.83936621741191}, "default_policy": {"total_loss": 9.83936621741191, "policy_loss": -0.002333838673832733, "vf_loss": 9.841510083375455, "vf_loss_unclipped": 2435.17771257673, "vf_explained_var": -0.05256986840447383, "entropy": 0.5213050973186615, "mean_kl_loss": 0.003799064422156295, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 76.0, "episode_reward_mean": 367.2, "episode_len_mean": 367.2, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44851049252038594, "mean_inference_ms": 1.4610505080531584, "mean_action_processing_ms": 0.11575530866960193, "mean_env_wait_ms": 0.05765700416932727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059070587158203125, "StateBufferConnector_ms": 0.00390625, "ViewRequirementAgentConnector_ms": 0.26456356048583984}}, "episode_reward_max": 500.0, "episode_reward_min": 76.0, "episode_reward_mean": 367.2, "episode_len_mean": 367.2, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [153.0, 301.0, 114.0, 95.0, 440.0, 121.0, 203.0, 239.0, 167.0, 500.0, 382.0, 193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [153, 301, 114, 95, 440, 121, 203, 239, 167, 500, 382, 193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44851049252038594, "mean_inference_ms": 1.4610505080531584, "mean_action_processing_ms": 0.11575530866960193, "mean_env_wait_ms": 0.05765700416932727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059070587158203125, "StateBufferConnector_ms": 0.00390625, "ViewRequirementAgentConnector_ms": 0.26456356048583984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 375.6151887271311, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 10541.898, "sample_time_ms": 4184.656, "synch_weights_time_ms": 3.581}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 454, "training_iteration": 13, "trial_id": "1acbb_00000", "date": "2023-12-05_19-31-06", "timestamp": 1701801066, "time_this_iter_s": 10.65198040008545, "time_total_s": 137.79744052886963, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 137.79744052886963, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.526666666666664, "ram_util_percent": 93.75999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.779621021579832}, "default_policy": {"total_loss": 9.779621021579832, "policy_loss": -0.0073491679901666225, "vf_loss": 9.78662574316647, "vf_loss_unclipped": 1790.6648388112278, "vf_explained_var": 0.017107145046628615, "entropy": 0.5209138433752792, "mean_kl_loss": 0.013776243534852186, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 381.29, "episode_len_mean": 381.29, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0], "episode_lengths": [193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44629820784689306, "mean_inference_ms": 1.4598431536395267, "mean_action_processing_ms": 0.11561543919074095, "mean_env_wait_ms": 0.05761368223369405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005963563919067383, "StateBufferConnector_ms": 0.0039038658142089844, "ViewRequirementAgentConnector_ms": 0.2634122371673584}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 381.29, "episode_len_mean": 381.29, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193.0, 199.0, 76.0, 367.0, 267.0, 286.0, 119.0, 255.0, 214.0, 500.0, 388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0], "episode_lengths": [193, 199, 76, 367, 267, 286, 119, 255, 214, 500, 388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44629820784689306, "mean_inference_ms": 1.4598431536395267, "mean_action_processing_ms": 0.11561543919074095, "mean_env_wait_ms": 0.05761368223369405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005963563919067383, "StateBufferConnector_ms": 0.0039038658142089844, "ViewRequirementAgentConnector_ms": 0.2634122371673584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 386.410964800273, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 10507.229, "sample_time_ms": 4180.461, "synch_weights_time_ms": 3.576}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 465, "training_iteration": 14, "trial_id": "1acbb_00000", "date": "2023-12-05_19-31-16", "timestamp": 1701801076, "time_this_iter_s": 10.354723930358887, "time_total_s": 148.15216445922852, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 148.15216445922852, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.65333333333334, "ram_util_percent": 93.71333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.738285457147464}, "default_policy": {"total_loss": 9.738285457147464, "policy_loss": -0.005508530036067721, "vf_loss": 9.743577749744407, "vf_loss_unclipped": 1425.971224640478, "vf_explained_var": 0.12144671345570449, "entropy": 0.5216664821227223, "mean_kl_loss": 0.008650696445902028, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 392.3, "episode_len_mean": 392.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0], "episode_lengths": [388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44441509670403356, "mean_inference_ms": 1.4585092710422884, "mean_action_processing_ms": 0.11554704141122077, "mean_env_wait_ms": 0.057559914161888305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005823850631713867, "StateBufferConnector_ms": 0.0038497447967529297, "ViewRequirementAgentConnector_ms": 0.261458158493042}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 392.3, "episode_len_mean": 392.3, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [388.0, 241.0, 181.0, 223.0, 341.0, 268.0, 460.0, 287.0, 353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0], "episode_lengths": [388, 241, 181, 223, 341, 268, 460, 287, 353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44441509670403356, "mean_inference_ms": 1.4585092710422884, "mean_action_processing_ms": 0.11554704141122077, "mean_env_wait_ms": 0.057559914161888305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005823850631713867, "StateBufferConnector_ms": 0.0038497447967529297, "ViewRequirementAgentConnector_ms": 0.261458158493042}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 374.27378168391897, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10511.044, "sample_time_ms": 4180.063, "synch_weights_time_ms": 3.557}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 475, "training_iteration": 15, "trial_id": "1acbb_00000", "date": "2023-12-05_19-31-27", "timestamp": 1701801087, "time_this_iter_s": 10.690362691879272, "time_total_s": 158.8425271511078, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 158.8425271511078, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.02, "ram_util_percent": 93.45999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.789745095950455}, "default_policy": {"total_loss": 9.789745095950455, "policy_loss": -0.003296969300096255, "vf_loss": 9.792776882521379, "vf_loss_unclipped": 1507.1859015361078, "vf_explained_var": 0.018277051924134115, "entropy": 0.5072492492923351, "mean_kl_loss": 0.010608438140115275, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 408.15, "episode_len_mean": 408.15, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0], "episode_lengths": [353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44326414248203166, "mean_inference_ms": 1.4580888270069243, "mean_action_processing_ms": 0.11548137814394009, "mean_env_wait_ms": 0.05754242040130004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005800008773803711, "StateBufferConnector_ms": 0.0038537979125976562, "ViewRequirementAgentConnector_ms": 0.26114964485168457}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 408.15, "episode_len_mean": 408.15, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [353.0, 185.0, 213.0, 222.0, 500.0, 500.0, 315.0, 320.0, 500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0], "episode_lengths": [353, 185, 213, 222, 500, 500, 315, 320, 500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44326414248203166, "mean_inference_ms": 1.4580888270069243, "mean_action_processing_ms": 0.11548137814394009, "mean_env_wait_ms": 0.05754242040130004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005800008773803711, "StateBufferConnector_ms": 0.0038537979125976562, "ViewRequirementAgentConnector_ms": 0.26114964485168457}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 376.1819465753623, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 10521.569, "sample_time_ms": 4182.039, "synch_weights_time_ms": 3.569}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 483, "training_iteration": 16, "trial_id": "1acbb_00000", "date": "2023-12-05_19-31-38", "timestamp": 1701801098, "time_this_iter_s": 10.636138677597046, "time_total_s": 169.47866582870483, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 169.47866582870483, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.333333333333332, "ram_util_percent": 93.46000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.77733504695933}, "default_policy": {"total_loss": 9.77733504695933, "policy_loss": -0.0019882660838705835, "vf_loss": 9.779212559209958, "vf_loss_unclipped": 1292.8536657727857, "vf_explained_var": 0.004169092249514452, "entropy": 0.5181062904947094, "mean_kl_loss": 0.004430489144901825, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.012500000186264515}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 422.07, "episode_len_mean": 422.07, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44223688276110024, "mean_inference_ms": 1.4577695389187517, "mean_action_processing_ms": 0.1154369854933211, "mean_env_wait_ms": 0.05752508033897255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058286190032958984, "StateBufferConnector_ms": 0.003881216049194336, "ViewRequirementAgentConnector_ms": 0.26271772384643555}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 422.07, "episode_len_mean": 422.07, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 430.0, 265.0, 405.0, 148.0, 341.0, 316.0, 202.0, 500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 430, 265, 405, 148, 341, 316, 202, 500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44223688276110024, "mean_inference_ms": 1.4577695389187517, "mean_action_processing_ms": 0.1154369854933211, "mean_env_wait_ms": 0.05752508033897255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058286190032958984, "StateBufferConnector_ms": 0.003881216049194336, "ViewRequirementAgentConnector_ms": 0.26271772384643555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 379.8352355414524, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 10510.606, "sample_time_ms": 4193.541, "synch_weights_time_ms": 3.596}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 491, "training_iteration": 17, "trial_id": "1acbb_00000", "date": "2023-12-05_19-31-48", "timestamp": 1701801108, "time_this_iter_s": 10.53348994255066, "time_total_s": 180.0121557712555, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 180.0121557712555, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.73333333333333, "ram_util_percent": 93.40000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.7575635401679}, "default_policy": {"total_loss": 9.7575635401679, "policy_loss": -0.0017926651897079654, "vf_loss": 9.759315590360272, "vf_loss_unclipped": 1090.568022315182, "vf_explained_var": -0.040366500933795596, "entropy": 0.5083707491599166, "mean_kl_loss": 0.003249795403065127, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0062500000931322575}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 436.0, "episode_len_mean": 436.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4411770484567561, "mean_inference_ms": 1.4571175367535136, "mean_action_processing_ms": 0.11541450293073535, "mean_env_wait_ms": 0.057489964997730285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00578618049621582, "StateBufferConnector_ms": 0.0038661956787109375, "ViewRequirementAgentConnector_ms": 0.26204895973205566}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 436.0, "episode_len_mean": 436.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 147.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 147, 500, 500, 500, 500, 500, 500, 500, 500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4411770484567561, "mean_inference_ms": 1.4571175367535136, "mean_action_processing_ms": 0.11541450293073535, "mean_env_wait_ms": 0.057489964997730285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00578618049621582, "StateBufferConnector_ms": 0.0038661956787109375, "ViewRequirementAgentConnector_ms": 0.26204895973205566}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 382.8823726872024, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 10503.05, "sample_time_ms": 4179.185, "synch_weights_time_ms": 3.612}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 499, "training_iteration": 18, "trial_id": "1acbb_00000", "date": "2023-12-05_19-31-59", "timestamp": 1701801119, "time_this_iter_s": 10.450359106063843, "time_total_s": 190.46251487731934, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 190.46251487731934, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.61333333333333, "ram_util_percent": 93.40666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.403874443538154}, "default_policy": {"total_loss": 9.403874443538154, "policy_loss": -0.00669057377830529, "vf_loss": 9.410505649123365, "vf_loss_unclipped": 743.2641043378346, "vf_explained_var": 0.11259676176093535, "entropy": 0.5100407751638498, "mean_kl_loss": 0.009500555256068674, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0062500000931322575}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 429.57, "episode_len_mean": 429.57, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0], "episode_lengths": [500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4400155163934623, "mean_inference_ms": 1.4562939313501415, "mean_action_processing_ms": 0.11530782945061784, "mean_env_wait_ms": 0.057450413270750594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059545040130615234, "StateBufferConnector_ms": 0.0038673877716064453, "ViewRequirementAgentConnector_ms": 0.2616860866546631}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 429.57, "episode_len_mean": 429.57, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 287.0, 328.0, 303.0, 500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0], "episode_lengths": [500, 500, 337, 500, 500, 500, 287, 328, 303, 500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4400155163934623, "mean_inference_ms": 1.4562939313501415, "mean_action_processing_ms": 0.11530782945061784, "mean_env_wait_ms": 0.057450413270750594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059545040130615234, "StateBufferConnector_ms": 0.0038673877716064453, "ViewRequirementAgentConnector_ms": 0.2616860866546631}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 388.3689701701887, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 10479.559, "sample_time_ms": 4166.456, "synch_weights_time_ms": 3.611}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 510, "training_iteration": 19, "trial_id": "1acbb_00000", "date": "2023-12-05_19-32-09", "timestamp": 1701801129, "time_this_iter_s": 10.30209493637085, "time_total_s": 200.76460981369019, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 200.76460981369019, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.506666666666664, "ram_util_percent": 93.37333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.684045413409724}, "default_policy": {"total_loss": 9.684045413409724, "policy_loss": -0.00588107299305864, "vf_loss": 9.689859521414425, "vf_loss_unclipped": 782.306153315725, "vf_explained_var": -0.043604905989124323, "entropy": 0.5057823608742594, "mean_kl_loss": 0.010713680455822903, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0062500000931322575}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 426.77, "episode_len_mean": 426.77, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0], "episode_lengths": [500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43897800105650525, "mean_inference_ms": 1.454948846090062, "mean_action_processing_ms": 0.11518902933914546, "mean_env_wait_ms": 0.05739435332098597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00600433349609375, "StateBufferConnector_ms": 0.0038383007049560547, "ViewRequirementAgentConnector_ms": 0.2599959373474121}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 426.77, "episode_len_mean": 426.77, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 433.0, 500.0, 322.0, 372.0, 476.0, 260.0, 342.0, 500.0, 289.0, 321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0], "episode_lengths": [500, 433, 500, 322, 372, 476, 260, 342, 500, 289, 321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43897800105650525, "mean_inference_ms": 1.454948846090062, "mean_action_processing_ms": 0.11518902933914546, "mean_env_wait_ms": 0.05739435332098597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00600433349609375, "StateBufferConnector_ms": 0.0038383007049560547, "ViewRequirementAgentConnector_ms": 0.2599959373474121}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 396.5341419371161, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 10421.906, "sample_time_ms": 4115.833, "synch_weights_time_ms": 3.579}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 519, "training_iteration": 20, "trial_id": "1acbb_00000", "date": "2023-12-05_19-32-19", "timestamp": 1701801139, "time_this_iter_s": 10.090341567993164, "time_total_s": 210.85495138168335, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 210.85495138168335, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.75, "ram_util_percent": 93.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.646407033334663}, "default_policy": {"total_loss": 9.646407033334663, "policy_loss": -0.004334440878800937, "vf_loss": 9.650713383261838, "vf_loss_unclipped": 610.111503682411, "vf_explained_var": 0.05594520553597001, "entropy": 0.4900988692731491, "mean_kl_loss": 0.004496437496940499, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 430.78, "episode_len_mean": 430.78, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0], "episode_lengths": [321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43784459721894164, "mean_inference_ms": 1.4531639554360816, "mean_action_processing_ms": 0.115057071680012, "mean_env_wait_ms": 0.057319801656822225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005954265594482422, "StateBufferConnector_ms": 0.003798246383666992, "ViewRequirementAgentConnector_ms": 0.2583277225494385}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 430.78, "episode_len_mean": 430.78, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [321.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 351.0, 301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0], "episode_lengths": [321, 500, 500, 500, 500, 500, 500, 351, 301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43784459721894164, "mean_inference_ms": 1.4531639554360816, "mean_action_processing_ms": 0.115057071680012, "mean_env_wait_ms": 0.057319801656822225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005954265594482422, "StateBufferConnector_ms": 0.003798246383666992, "ViewRequirementAgentConnector_ms": 0.2583277225494385}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 377.44962258673377, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 84000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 10471.617, "sample_time_ms": 4125.353, "synch_weights_time_ms": 3.587}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 529, "training_iteration": 21, "trial_id": "1acbb_00000", "date": "2023-12-05_19-32-30", "timestamp": 1701801150, "time_this_iter_s": 10.600680589675903, "time_total_s": 221.45563197135925, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 221.45563197135925, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.493333333333332, "ram_util_percent": 93.37333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.547868661534812}, "default_policy": {"total_loss": 9.547868661534812, "policy_loss": -0.007978840318045764, "vf_loss": 9.555825050959964, "vf_loss_unclipped": 533.8342442705687, "vf_explained_var": -0.014301463040207494, "entropy": 0.5013509182724109, "mean_kl_loss": 0.007186348625372206, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 430.32, "episode_len_mean": 430.32, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0], "episode_lengths": [301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4370592580179666, "mean_inference_ms": 1.4518998038660391, "mean_action_processing_ms": 0.11495316724155497, "mean_env_wait_ms": 0.05726968939073224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006058931350708008, "StateBufferConnector_ms": 0.003799915313720703, "ViewRequirementAgentConnector_ms": 0.25809764862060547}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 430.32, "episode_len_mean": 430.32, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [301.0, 311.0, 434.0, 260.0, 500.0, 389.0, 457.0, 447.0, 258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0], "episode_lengths": [301, 311, 434, 260, 500, 389, 457, 447, 258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4370592580179666, "mean_inference_ms": 1.4518998038660391, "mean_action_processing_ms": 0.11495316724155497, "mean_env_wait_ms": 0.05726968939073224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006058931350708008, "StateBufferConnector_ms": 0.003799915313720703, "ViewRequirementAgentConnector_ms": 0.25809764862060547}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 388.08293315952596, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 88000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 10459.04, "sample_time_ms": 4115.921, "synch_weights_time_ms": 3.151}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 537, "training_iteration": 22, "trial_id": "1acbb_00000", "date": "2023-12-05_19-32-40", "timestamp": 1701801160, "time_this_iter_s": 10.309674978256226, "time_total_s": 231.76530694961548, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 231.76530694961548, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.04666666666667, "ram_util_percent": 93.40000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.579178169592103}, "default_policy": {"total_loss": 9.579178169592103, "policy_loss": -0.0013179913478921345, "vf_loss": 9.580479952318074, "vf_loss_unclipped": 349.3738442443327, "vf_explained_var": -0.03422227203210534, "entropy": 0.46265332985407254, "mean_kl_loss": 0.005179086322757877, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 439.33, "episode_len_mean": 439.33, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43630128716844707, "mean_inference_ms": 1.4506607203983026, "mean_action_processing_ms": 0.11484920102678794, "mean_env_wait_ms": 0.057220976344622254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006001710891723633, "StateBufferConnector_ms": 0.0037810802459716797, "ViewRequirementAgentConnector_ms": 0.2562744617462158}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 439.33, "episode_len_mean": 439.33, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [258.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [258, 500, 500, 500, 500, 500, 500, 500, 500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43630128716844707, "mean_inference_ms": 1.4506607203983026, "mean_action_processing_ms": 0.11484920102678794, "mean_env_wait_ms": 0.057220976344622254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006001710891723633, "StateBufferConnector_ms": 0.0037810802459716797, "ViewRequirementAgentConnector_ms": 0.2562744617462158}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 390.9262472383631, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 92000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 10417.331, "sample_time_ms": 4090.754, "synch_weights_time_ms": 3.153}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 545, "training_iteration": 23, "trial_id": "1acbb_00000", "date": "2023-12-05_19-32-50", "timestamp": 1701801170, "time_this_iter_s": 10.235004186630249, "time_total_s": 242.00031113624573, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 242.00031113624573, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.65, "ram_util_percent": 93.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.455920846731678}, "default_policy": {"total_loss": 9.455920846731678, "policy_loss": -0.005589964678451451, "vf_loss": 9.461478779310864, "vf_loss_unclipped": 220.1987577735234, "vf_explained_var": -0.06359474650069849, "entropy": 0.4823502612584181, "mean_kl_loss": 0.0102563868729783, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 441.75, "episode_len_mean": 441.75, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43556101652666596, "mean_inference_ms": 1.4491467661467947, "mean_action_processing_ms": 0.11473972239355526, "mean_env_wait_ms": 0.05716950236095128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00592350959777832, "StateBufferConnector_ms": 0.003750324249267578, "ViewRequirementAgentConnector_ms": 0.25391483306884766}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 441.75, "episode_len_mean": 441.75, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 445.0, 500.0, 500.0, 253.0, 500.0, 424.0, 500.0, 352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 445, 500, 500, 253, 500, 424, 500, 352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43556101652666596, "mean_inference_ms": 1.4491467661467947, "mean_action_processing_ms": 0.11473972239355526, "mean_env_wait_ms": 0.05716950236095128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00592350959777832, "StateBufferConnector_ms": 0.003750324249267578, "ViewRequirementAgentConnector_ms": 0.25391483306884766}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 390.36765495787415, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 96000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 10406.839, "sample_time_ms": 4075.445, "synch_weights_time_ms": 3.156}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 553, "training_iteration": 24, "trial_id": "1acbb_00000", "date": "2023-12-05_19-33-00", "timestamp": 1701801180, "time_this_iter_s": 10.24928879737854, "time_total_s": 252.24959993362427, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 252.24959993362427, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 21.56, "ram_util_percent": 93.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.227583383446309}, "default_policy": {"total_loss": 9.227583383446309, "policy_loss": -0.0006422662118604697, "vf_loss": 9.228215334512024, "vf_loss_unclipped": 110.32233475927097, "vf_explained_var": -0.07290927586016624, "entropy": 0.45601288742348073, "mean_kl_loss": 0.003299401797580585, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0015625000232830644}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 445.53, "episode_len_mean": 445.53, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4348433766045774, "mean_inference_ms": 1.4475162189242874, "mean_action_processing_ms": 0.1146096252971448, "mean_env_wait_ms": 0.05711672843981387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005792856216430664, "StateBufferConnector_ms": 0.003745555877685547, "ViewRequirementAgentConnector_ms": 0.25263142585754395}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 445.53, "episode_len_mean": 445.53, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.0, 37.0, 228.0, 385.0, 500.0, 500.0, 363.0, 231.0, 226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [352, 37, 228, 385, 500, 500, 363, 231, 226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4348433766045774, "mean_inference_ms": 1.4475162189242874, "mean_action_processing_ms": 0.1146096252971448, "mean_env_wait_ms": 0.05711672843981387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005792856216430664, "StateBufferConnector_ms": 0.003745555877685547, "ViewRequirementAgentConnector_ms": 0.25263142585754395}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 393.3039187892837, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 100000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 10355.128, "sample_time_ms": 4050.647, "synch_weights_time_ms": 3.149}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 561, "training_iteration": 25, "trial_id": "1acbb_00000", "date": "2023-12-05_19-33-11", "timestamp": 1701801191, "time_this_iter_s": 10.17306637763977, "time_total_s": 262.42266631126404, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 262.42266631126404, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.007142857142856, "ram_util_percent": 93.31428571428569}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 6.990637769317635}, "default_policy": {"total_loss": 6.990637769317635, "policy_loss": -0.002806302330800211, "vf_loss": 6.993435012204434, "vf_loss_unclipped": 26.635385691182318, "vf_explained_var": -0.02519598482514241, "entropy": 0.43949291427760745, "mean_kl_loss": 0.005806372442416033, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0015625000232830644}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 459.57, "episode_len_mean": 459.57, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43409705008797017, "mean_inference_ms": 1.4458396735159176, "mean_action_processing_ms": 0.11448625554005581, "mean_env_wait_ms": 0.057056639367953264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005770206451416016, "StateBufferConnector_ms": 0.0037255287170410156, "ViewRequirementAgentConnector_ms": 0.251706600189209}}, "episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 459.57, "episode_len_mean": 459.57, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [226.0, 182.0, 419.0, 465.0, 344.0, 347.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [226, 182, 419, 465, 344, 347, 500, 500, 500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43409705008797017, "mean_inference_ms": 1.4458396735159176, "mean_action_processing_ms": 0.11448625554005581, "mean_env_wait_ms": 0.057056639367953264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005770206451416016, "StateBufferConnector_ms": 0.0037255287170410156, "ViewRequirementAgentConnector_ms": 0.251706600189209}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 385.69796915862923, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 104000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 10328.894, "sample_time_ms": 4036.529, "synch_weights_time_ms": 3.146}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 569, "training_iteration": 26, "trial_id": "1acbb_00000", "date": "2023-12-05_19-33-21", "timestamp": 1701801201, "time_this_iter_s": 10.373335361480713, "time_total_s": 272.79600167274475, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 272.79600167274475, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.4, "ram_util_percent": 93.08666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.13904636559196498}, "default_policy": {"total_loss": 0.13904636559196498, "policy_loss": -0.002512142579478305, "vf_loss": 0.14155010412782748, "vf_loss_unclipped": 0.14155010412782748, "vf_explained_var": -0.1124112483407897, "entropy": 0.476352097700908, "mean_kl_loss": 0.005379335517085689, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0015625000232830644}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 469.74, "episode_len_mean": 469.74, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43340277824767065, "mean_inference_ms": 1.444306167853222, "mean_action_processing_ms": 0.11438157711883098, "mean_env_wait_ms": 0.056997009253363054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005820035934448242, "StateBufferConnector_ms": 0.0037407875061035156, "ViewRequirementAgentConnector_ms": 0.25203800201416016}}, "episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 469.74, "episode_len_mean": 469.74, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 474.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 474, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43340277824767065, "mean_inference_ms": 1.444306167853222, "mean_action_processing_ms": 0.11438157711883098, "mean_env_wait_ms": 0.056997009253363054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005820035934448242, "StateBufferConnector_ms": 0.0037407875061035156, "ViewRequirementAgentConnector_ms": 0.25203800201416016}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 344.87710840599635, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 108000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 10435.638, "sample_time_ms": 4021.098, "synch_weights_time_ms": 3.373}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 577, "training_iteration": 27, "trial_id": "1acbb_00000", "date": "2023-12-05_19-33-33", "timestamp": 1701801213, "time_this_iter_s": 11.602680444717407, "time_total_s": 284.39868211746216, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 284.39868211746216, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.3, "ram_util_percent": 93.34705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 4.512696583276745}, "default_policy": {"total_loss": 4.512696583276745, "policy_loss": -0.004820728496805246, "vf_loss": 4.517507474843178, "vf_loss_unclipped": 680.2049205828362, "vf_explained_var": -0.07728313065286893, "entropy": 0.4594262580691116, "mean_kl_loss": 0.006296023390042391, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0015625000232830644}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 461.61, "episode_len_mean": 461.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43255973459988645, "mean_inference_ms": 1.4421275902632331, "mean_action_processing_ms": 0.11421145622493878, "mean_env_wait_ms": 0.056926270291089535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00590825080871582, "StateBufferConnector_ms": 0.0037186145782470703, "ViewRequirementAgentConnector_ms": 0.24977970123291016}}, "episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 461.61, "episode_len_mean": 461.61, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43255973459988645, "mean_inference_ms": 1.4421275902632331, "mean_action_processing_ms": 0.11421145622493878, "mean_env_wait_ms": 0.056926270291089535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00590825080871582, "StateBufferConnector_ms": 0.0037186145782470703, "ViewRequirementAgentConnector_ms": 0.24977970123291016}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 380.0999044744231, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 10443.284, "sample_time_ms": 4020.685, "synch_weights_time_ms": 3.396}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 587, "training_iteration": 28, "trial_id": "1acbb_00000", "date": "2023-12-05_19-33-43", "timestamp": 1701801223, "time_this_iter_s": 10.526285409927368, "time_total_s": 294.9249675273895, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 294.9249675273895, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 25.193333333333335, "ram_util_percent": 93.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0035789387900310794}, "default_policy": {"total_loss": 0.0035789387900310794, "policy_loss": -0.0009371839038757627, "vf_loss": 0.004509204349345662, "vf_loss_unclipped": 0.004509204349345662, "vf_explained_var": -0.3630377188293156, "entropy": 0.43254994110130807, "mean_kl_loss": 0.004428617611594177, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0007812500116415322}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 461.61, "episode_len_mean": 461.61, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4318557263587832, "mean_inference_ms": 1.440453892030558, "mean_action_processing_ms": 0.11408939858959882, "mean_env_wait_ms": 0.05686779506665387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006068229675292969, "StateBufferConnector_ms": 0.0036859512329101562, "ViewRequirementAgentConnector_ms": 0.2482309341430664}}, "episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 461.61, "episode_len_mean": 461.61, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 148.0, 428.0, 493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 148, 428, 493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4318557263587832, "mean_inference_ms": 1.440453892030558, "mean_action_processing_ms": 0.11408939858959882, "mean_env_wait_ms": 0.05686779506665387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006068229675292969, "StateBufferConnector_ms": 0.0036859512329101562, "ViewRequirementAgentConnector_ms": 0.2482309341430664}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 382.82366249210867, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 116000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 10458.203, "sample_time_ms": 4023.126, "synch_weights_time_ms": 3.371}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 595, "training_iteration": 29, "trial_id": "1acbb_00000", "date": "2023-12-05_19-33-54", "timestamp": 1701801234, "time_this_iter_s": 10.451603174209595, "time_total_s": 305.3765707015991, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 305.3765707015991, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.279999999999994, "ram_util_percent": 93.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": -0.002106819916824956}, "default_policy": {"total_loss": -0.002106819916824956, "policy_loss": -0.0028823907340644423, "vf_loss": 0.0007732895323630894, "vf_loss_unclipped": 0.0007732895323630894, "vf_explained_var": -0.6489713286667236, "entropy": 0.47818004627471794, "mean_kl_loss": 0.0029188954224714414, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 465.85, "episode_len_mean": 465.85, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43124427437216495, "mean_inference_ms": 1.4390181408818286, "mean_action_processing_ms": 0.1139839308461629, "mean_env_wait_ms": 0.056818270016093464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006234884262084961, "StateBufferConnector_ms": 0.0037293434143066406, "ViewRequirementAgentConnector_ms": 0.24953246116638184}}, "episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 465.85, "episode_len_mean": 465.85, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [493.0, 133.0, 500.0, 500.0, 500.0, 352.0, 450.0, 500.0, 500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [493, 133, 500, 500, 500, 352, 450, 500, 500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43124427437216495, "mean_inference_ms": 1.4390181408818286, "mean_action_processing_ms": 0.1139839308461629, "mean_env_wait_ms": 0.056818270016093464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006234884262084961, "StateBufferConnector_ms": 0.0037293434143066406, "ViewRequirementAgentConnector_ms": 0.24953246116638184}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 377.6428752242317, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 120000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 10508.665, "sample_time_ms": 4050.166, "synch_weights_time_ms": 3.569}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 603, "training_iteration": 30, "trial_id": "1acbb_00000", "date": "2023-12-05_19-34-04", "timestamp": 1701801244, "time_this_iter_s": 10.595216035842896, "time_total_s": 315.971786737442, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 315.971786737442, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 24.88, "ram_util_percent": 93.44000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.8898471483130699}, "default_policy": {"total_loss": 0.8898471483130699, "policy_loss": -0.005351508028312787, "vf_loss": 0.8951945053870091, "vf_loss_unclipped": 122.97719468814985, "vf_explained_var": -0.8270285489208409, "entropy": 0.4605912896615864, "mean_kl_loss": 0.010624067487094798, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 470.18, "episode_len_mean": 470.18, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0], "episode_lengths": [500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43065266396198987, "mean_inference_ms": 1.4377670927367898, "mean_action_processing_ms": 0.11390174160778738, "mean_env_wait_ms": 0.05677107752523554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006037712097167969, "StateBufferConnector_ms": 0.0037262439727783203, "ViewRequirementAgentConnector_ms": 0.24906182289123535}}, "episode_reward_max": 500.0, "episode_reward_min": 122.0, "episode_reward_mean": 470.18, "episode_len_mean": 470.18, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 149.0, 500.0, 204.0, 500.0, 122.0, 500.0, 500.0, 202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0], "episode_lengths": [500, 149, 500, 204, 500, 122, 500, 500, 202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43065266396198987, "mean_inference_ms": 1.4377670927367898, "mean_action_processing_ms": 0.11390174160778738, "mean_env_wait_ms": 0.05677107752523554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006037712097167969, "StateBufferConnector_ms": 0.0037262439727783203, "ViewRequirementAgentConnector_ms": 0.24906182289123535}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 377.4604583931303, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 124000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 10508.635, "sample_time_ms": 4049.1, "synch_weights_time_ms": 3.55}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 611, "training_iteration": 31, "trial_id": "1acbb_00000", "date": "2023-12-05_19-34-15", "timestamp": 1701801255, "time_this_iter_s": 10.599828481674194, "time_total_s": 326.5716152191162, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 326.5716152191162, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.186666666666664, "ram_util_percent": 93.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": -0.0011939312434265776}, "default_policy": {"total_loss": -0.0011939312434265776, "policy_loss": -0.0016375039100968666, "vf_loss": 0.00044137916278281397, "vf_loss_unclipped": 0.00044137916278281397, "vf_explained_var": -0.7365041799636792, "entropy": 0.4244693893550047, "mean_kl_loss": 0.005613500762157724, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 202.0, "episode_reward_mean": 480.43, "episode_len_mean": 480.43, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4301835985006051, "mean_inference_ms": 1.4368228791521478, "mean_action_processing_ms": 0.11383219129565095, "mean_env_wait_ms": 0.05674065787160119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005996227264404297, "StateBufferConnector_ms": 0.003753662109375, "ViewRequirementAgentConnector_ms": 0.2504405975341797}}, "episode_reward_max": 500.0, "episode_reward_min": 202.0, "episode_reward_mean": 480.43, "episode_len_mean": 480.43, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [202.0, 468.0, 500.0, 310.0, 500.0, 500.0, 500.0, 500.0, 415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [202, 468, 500, 310, 500, 500, 500, 500, 415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4301835985006051, "mean_inference_ms": 1.4368228791521478, "mean_action_processing_ms": 0.11383219129565095, "mean_env_wait_ms": 0.05674065787160119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005996227264404297, "StateBufferConnector_ms": 0.003753662109375, "ViewRequirementAgentConnector_ms": 0.2504405975341797}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 379.79845926099915, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 128000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 10531.118, "sample_time_ms": 4065.832, "synch_weights_time_ms": 3.575}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 619, "training_iteration": 32, "trial_id": "1acbb_00000", "date": "2023-12-05_19-34-25", "timestamp": 1701801265, "time_this_iter_s": 10.535170793533325, "time_total_s": 337.10678601264954, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 337.10678601264954, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.57333333333333, "ram_util_percent": 93.4066666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": -0.004566456127449123}, "default_policy": {"total_loss": -0.004566456127449123, "policy_loss": -0.004624693562884304, "vf_loss": 5.43985826840335e-05, "vf_loss_unclipped": 5.43985826840335e-05, "vf_explained_var": -0.8767391342216971, "entropy": 0.42263252410426067, "mean_kl_loss": 0.00982762212049232, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 255.0, "episode_reward_mean": 485.63, "episode_len_mean": 485.63, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4297439499594046, "mean_inference_ms": 1.4358510444428652, "mean_action_processing_ms": 0.11375137718811519, "mean_env_wait_ms": 0.05671441788048867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005969047546386719, "StateBufferConnector_ms": 0.0037283897399902344, "ViewRequirementAgentConnector_ms": 0.24855709075927734}}, "episode_reward_max": 500.0, "episode_reward_min": 255.0, "episode_reward_mean": 485.63, "episode_len_mean": 485.63, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [415.0, 500.0, 500.0, 500.0, 500.0, 400.0, 255.0, 500.0, 471.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [415, 500, 500, 500, 500, 400, 255, 500, 471, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4297439499594046, "mean_inference_ms": 1.4358510444428652, "mean_action_processing_ms": 0.11375137718811519, "mean_env_wait_ms": 0.05671441788048867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005969047546386719, "StateBufferConnector_ms": 0.0037283897399902344, "ViewRequirementAgentConnector_ms": 0.24855709075927734}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 382.24315769748, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 132000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 10554.361, "sample_time_ms": 4083.428, "synch_weights_time_ms": 3.597}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 627, "training_iteration": 33, "trial_id": "1acbb_00000", "date": "2023-12-05_19-34-36", "timestamp": 1701801276, "time_this_iter_s": 10.467347145080566, "time_total_s": 347.5741331577301, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 347.5741331577301, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 22.39333333333333, "ram_util_percent": 93.24000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 6.089578859190316}, "default_policy": {"total_loss": 6.089578859190316, "policy_loss": -0.007189318837562223, "vf_loss": 6.096763492631934, "vf_loss_unclipped": 1421.0312013761297, "vf_explained_var": -0.24691257770381755, "entropy": 0.45349813003275696, "mean_kl_loss": 0.011967236019021582, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 454.62, "episode_len_mean": 454.62, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.429066918882288, "mean_inference_ms": 1.4346018583430915, "mean_action_processing_ms": 0.11364955834048512, "mean_env_wait_ms": 0.05668312740260831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059814453125, "StateBufferConnector_ms": 0.0037660598754882812, "ViewRequirementAgentConnector_ms": 0.2519817352294922}}, "episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 454.62, "episode_len_mean": 454.62, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.429066918882288, "mean_inference_ms": 1.4346018583430915, "mean_action_processing_ms": 0.11364955834048512, "mean_env_wait_ms": 0.05668312740260831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059814453125, "StateBufferConnector_ms": 0.0037660598754882812, "ViewRequirementAgentConnector_ms": 0.2519817352294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 379.79706642519216, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 136000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 10582.882, "sample_time_ms": 4100.349, "synch_weights_time_ms": 3.587}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 643, "training_iteration": 34, "trial_id": "1acbb_00000", "date": "2023-12-05_19-34-46", "timestamp": 1701801286, "time_this_iter_s": 10.535260438919067, "time_total_s": 358.10939359664917, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 358.10939359664917, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.46, "ram_util_percent": 93.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": -0.004861253118653975}, "default_policy": {"total_loss": -0.004861253118653975, "policy_loss": -0.004900348334283288, "vf_loss": 3.4923913299881846e-05, "vf_loss_unclipped": 3.4923913299881846e-05, "vf_explained_var": -0.9095486349134303, "entropy": 0.40722740258870604, "mean_kl_loss": 0.010674171989368458, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 454.62, "episode_len_mean": 454.62, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4288339839132334, "mean_inference_ms": 1.4342643082798765, "mean_action_processing_ms": 0.11362393810294989, "mean_env_wait_ms": 0.05667609668059921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006270408630371094, "StateBufferConnector_ms": 0.003810405731201172, "ViewRequirementAgentConnector_ms": 0.2549896240234375}}, "episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 454.62, "episode_len_mean": 454.62, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4288339839132334, "mean_inference_ms": 1.4342643082798765, "mean_action_processing_ms": 0.11362393810294989, "mean_env_wait_ms": 0.05667609668059921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006270408630371094, "StateBufferConnector_ms": 0.003810405731201172, "ViewRequirementAgentConnector_ms": 0.2549896240234375}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 387.70851572291815, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 140000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 10597.559, "sample_time_ms": 4110.737, "synch_weights_time_ms": 3.61}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 651, "training_iteration": 35, "trial_id": "1acbb_00000", "date": "2023-12-05_19-34-57", "timestamp": 1701801297, "time_this_iter_s": 10.320085763931274, "time_total_s": 368.42947936058044, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 368.42947936058044, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 22.766666666666666, "ram_util_percent": 93.19333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 7.58106052084391}, "default_policy": {"total_loss": 7.58106052084391, "policy_loss": -0.005777324017917694, "vf_loss": 7.58683304410817, "vf_loss_unclipped": 1322.2420492810386, "vf_explained_var": -0.08930797534964995, "entropy": 0.4574444217722553, "mean_kl_loss": 0.012330875213376924, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 432.06, "episode_len_mean": 432.06, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4286117843189168, "mean_inference_ms": 1.4340992681532594, "mean_action_processing_ms": 0.11360977186055585, "mean_env_wait_ms": 0.05668023641912957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006533384323120117, "StateBufferConnector_ms": 0.003863811492919922, "ViewRequirementAgentConnector_ms": 0.2598142623901367}}, "episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 432.06, "episode_len_mean": 432.06, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4286117843189168, "mean_inference_ms": 1.4340992681532594, "mean_action_processing_ms": 0.11360977186055585, "mean_env_wait_ms": 0.05668023641912957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006533384323120117, "StateBufferConnector_ms": 0.003863811492919922, "ViewRequirementAgentConnector_ms": 0.2598142623901367}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 382.38074567137215, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 144000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 10606.554, "sample_time_ms": 4130.161, "synch_weights_time_ms": 3.591}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 663, "training_iteration": 36, "trial_id": "1acbb_00000", "date": "2023-12-05_19-35-07", "timestamp": 1701801307, "time_this_iter_s": 10.463785648345947, "time_total_s": 378.8932650089264, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 378.8932650089264, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 26.021428571428572, "ram_util_percent": 93.11428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7555284146418069}, "default_policy": {"total_loss": 0.7555284146418069, "policy_loss": -0.006128982797678091, "vf_loss": 0.7616556097870257, "vf_loss_unclipped": 189.95888166681866, "vf_explained_var": -0.09635753843830085, "entropy": 0.40963563224527116, "mean_kl_loss": 0.004596943451276077, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.00019531250291038305}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 429.06, "episode_len_mean": 429.06, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0, 432.0, 500.0, 500.0, 500.0, 268.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234, 432, 500, 500, 500, 268, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42850438820766246, "mean_inference_ms": 1.4341252052116857, "mean_action_processing_ms": 0.11360900092998846, "mean_env_wait_ms": 0.05668754456469656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006560087203979492, "StateBufferConnector_ms": 0.0038754940032958984, "ViewRequirementAgentConnector_ms": 0.25989699363708496}}, "episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 429.06, "episode_len_mean": 429.06, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 468.0, 283.0, 500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0, 432.0, 500.0, 500.0, 500.0, 268.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 468, 283, 500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234, 432, 500, 500, 500, 268, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42850438820766246, "mean_inference_ms": 1.4341252052116857, "mean_action_processing_ms": 0.11360900092998846, "mean_env_wait_ms": 0.05668754456469656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006560087203979492, "StateBufferConnector_ms": 0.0038754940032958984, "ViewRequirementAgentConnector_ms": 0.25989699363708496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 384.7898213863828, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 148000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 10486.251, "sample_time_ms": 4126.601, "synch_weights_time_ms": 3.332}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 671, "training_iteration": 37, "trial_id": "1acbb_00000", "date": "2023-12-05_19-35-18", "timestamp": 1701801318, "time_this_iter_s": 10.3981614112854, "time_total_s": 389.2914264202118, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 389.2914264202118, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.96, "ram_util_percent": 93.16666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": -0.0003602936698088069}, "default_policy": {"total_loss": -0.0003602936698088069, "policy_loss": -0.0008634710411376345, "vf_loss": 0.0005024179819781233, "vf_loss_unclipped": 0.0005024179819781233, "vf_explained_var": -0.41335660943598634, "entropy": 0.3972516917724853, "mean_kl_loss": 0.003892431786388985, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.765625145519152e-05}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 431.55, "episode_len_mean": 431.55, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0, 432.0, 500.0, 500.0, 500.0, 268.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234, 432, 500, 500, 500, 268, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4283924332506138, "mean_inference_ms": 1.4341296759142756, "mean_action_processing_ms": 0.11360944299030155, "mean_env_wait_ms": 0.056694152349334385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006511688232421875, "StateBufferConnector_ms": 0.003839254379272461, "ViewRequirementAgentConnector_ms": 0.2593529224395752}}, "episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 431.55, "episode_len_mean": 431.55, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 412.0, 500.0, 500.0, 322.0, 323.0, 353.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0, 432.0, 500.0, 500.0, 500.0, 268.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 412, 500, 500, 322, 323, 353, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234, 432, 500, 500, 500, 268, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4283924332506138, "mean_inference_ms": 1.4341296759142756, "mean_action_processing_ms": 0.11360944299030155, "mean_env_wait_ms": 0.056694152349334385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006511688232421875, "StateBufferConnector_ms": 0.003839254379272461, "ViewRequirementAgentConnector_ms": 0.2593529224395752}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 379.83847756123515, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 152000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 10486.977, "sample_time_ms": 4131.943, "synch_weights_time_ms": 3.311}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 679, "training_iteration": 38, "trial_id": "1acbb_00000", "date": "2023-12-05_19-35-28", "timestamp": 1701801328, "time_this_iter_s": 10.533651351928711, "time_total_s": 399.8250777721405, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 399.8250777721405, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.486666666666665, "ram_util_percent": 93.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": -0.0019123548799606937}, "default_policy": {"total_loss": -0.0019123548799606937, "policy_loss": -0.0019818973689794796, "vf_loss": 6.891368698990443e-05, "vf_loss_unclipped": 6.891368698990443e-05, "vf_explained_var": -0.6153842927550456, "entropy": 0.36794176195730277, "mean_kl_loss": 0.006431639004433705, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.765625145519152e-05}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 437.45, "episode_len_mean": 437.45, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0, 432.0, 500.0, 500.0, 500.0, 268.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234, 432, 500, 500, 500, 268, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4283033149957969, "mean_inference_ms": 1.4342259462071791, "mean_action_processing_ms": 0.11362839244279403, "mean_env_wait_ms": 0.05669979612123701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006550788879394531, "StateBufferConnector_ms": 0.0038640499114990234, "ViewRequirementAgentConnector_ms": 0.2610146999359131}}, "episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 437.45, "episode_len_mean": 437.45, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0, 432.0, 500.0, 500.0, 500.0, 268.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234, 432, 500, 500, 500, 268, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4283033149957969, "mean_inference_ms": 1.4342259462071791, "mean_action_processing_ms": 0.11362839244279403, "mean_env_wait_ms": 0.05669979612123701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006550788879394531, "StateBufferConnector_ms": 0.0038640499114990234, "ViewRequirementAgentConnector_ms": 0.2610146999359131}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 379.0956638766049, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 156000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 10497.251, "sample_time_ms": 4133.839, "synch_weights_time_ms": 3.438}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 687, "training_iteration": 39, "trial_id": "1acbb_00000", "date": "2023-12-05_19-35-39", "timestamp": 1701801339, "time_this_iter_s": 10.555009603500366, "time_total_s": 410.38008737564087, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 410.38008737564087, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 24.48666666666667, "ram_util_percent": 93.19333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": -0.005322788405154687}, "default_policy": {"total_loss": -0.005322788405154687, "policy_loss": -0.0053339417912622, "vf_loss": 1.006581450294033e-05, "vf_loss_unclipped": 1.006581450294033e-05, "vf_explained_var": -0.9249760396063709, "entropy": 0.39627534764280703, "mean_kl_loss": 0.011101645571573854, "default_optimizer_lr": 5.000000000000001e-05, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.765625145519152e-05}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 437.45, "episode_len_mean": 437.45, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0, 432.0, 500.0, 500.0, 500.0, 268.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234, 432, 500, 500, 500, 268, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42823726225956804, "mean_inference_ms": 1.434348209716454, "mean_action_processing_ms": 0.1136392922632978, "mean_env_wait_ms": 0.05671138072566789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00664210319519043, "StateBufferConnector_ms": 0.003858327865600586, "ViewRequirementAgentConnector_ms": 0.2607605457305908}}, "episode_reward_max": 500.0, "episode_reward_min": 91.0, "episode_reward_mean": 437.45, "episode_len_mean": 437.45, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 189.0, 175.0, 307.0, 500.0, 121.0, 237.0, 500.0, 233.0, 91.0, 267.0, 290.0, 156.0, 245.0, 500.0, 129.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 416.0, 427.0, 168.0, 286.0, 304.0, 355.0, 396.0, 162.0, 277.0, 219.0, 500.0, 234.0, 432.0, 500.0, 500.0, 500.0, 268.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 361, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 189, 175, 307, 500, 121, 237, 500, 233, 91, 267, 290, 156, 245, 500, 129, 500, 500, 500, 500, 500, 500, 500, 500, 416, 427, 168, 286, 304, 355, 396, 162, 277, 219, 500, 234, 432, 500, 500, 500, 268, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42823726225956804, "mean_inference_ms": 1.434348209716454, "mean_action_processing_ms": 0.1136392922632978, "mean_env_wait_ms": 0.05671138072566789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00664210319519043, "StateBufferConnector_ms": 0.003858327865600586, "ViewRequirementAgentConnector_ms": 0.2607605457305908}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 377.226794364061, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 160000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 10498.418, "sample_time_ms": 4136.222, "synch_weights_time_ms": 3.241}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "done": true, "episodes_total": 695, "training_iteration": 40, "trial_id": "1acbb_00000", "date": "2023-12-05_19-35-49", "timestamp": 1701801349, "time_this_iter_s": 10.607942342758179, "time_total_s": 420.98802971839905, "pid": 14790, "hostname": "adri", "node_ip": "84.88.188.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbdebb9fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": "./example/cartpole/", "output_config": {}, "output_compress_columns": [], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 420.98802971839905, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 24.953333333333333, "ram_util_percent": 93.20000000000002}}
